

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>1. Installation &mdash; Charliecloud 0.2.0.pre documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="search" title="Search" href="search.html"/>
        <link rel="copyright" title="Copyright" href="copyright.html"/>
    <link rel="top" title="Charliecloud 0.2.0.pre documentation" href="index.html"/>
        <link rel="next" title="2. Tutorial" href="tutorial.html"/>
        <link rel="prev" title="Overview" href="index.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Charliecloud
          

          
          </a>

          
            
            
              <div class="version">
                cb981d4
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">1. Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#prequisites">1.1. Prequisites</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#run-time">1.1.1. Run time</a></li>
<li class="toctree-l3"><a class="reference internal" href="#build-time">1.1.2. Build time</a></li>
<li class="toctree-l3"><a class="reference internal" href="#test-suite">1.1.3. Test suite</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#install-docker-build-systems-only">1.2. Install Docker (build systems only)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#understand-the-security-implications-of-docker">1.2.1. Understand the security implications of Docker</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#don-t-pipe-web-pages-to-your-shell">1.2.1.1. Don&#8217;t pipe web pages to your shell</a></li>
<li class="toctree-l4"><a class="reference internal" href="#docker-equals-root">1.2.1.2. <code class="code docutils literal"><span class="pre">docker</span></code> equals root</a></li>
<li class="toctree-l4"><a class="reference internal" href="#images-can-contain-bad-stuff">1.2.1.3. Images can contain bad stuff</a></li>
<li class="toctree-l4"><a class="reference internal" href="#containers-run-as-root">1.2.1.4. Containers run as root</a></li>
<li class="toctree-l4"><a class="reference internal" href="#docker-alters-your-network-configuration">1.2.1.5. Docker alters your network configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#docker-installs-services">1.2.1.6. Docker installs services</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#configuring-docker-for-a-proxy">1.2.2. Configuring Docker for a proxy</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#install-charliecloud">1.3. Install Charliecloud</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#download">1.3.1. Download</a></li>
<li class="toctree-l3"><a class="reference internal" href="#build">1.3.2. Build</a></li>
<li class="toctree-l3"><a class="reference internal" href="#install-optional">1.3.3. Install (optional)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#test-charliecloud">1.4. Test Charliecloud</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">1.4.1. Build</a></li>
<li class="toctree-l3"><a class="reference internal" href="#run">1.4.2. Run</a></li>
<li class="toctree-l3"><a class="reference internal" href="#test-suites-of-examples">1.4.3. Test suites of examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="#multiple-phases">1.4.4. Multiple phases</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">2. Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="script-help.html">3. Help text for executables</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">4. Frequently asked questions (FAQ)</a></li>
<li class="toctree-l1"><a class="reference internal" href="copyright.html">5. Copyright and license</a></li>
<li class="toctree-l1"><a class="reference internal" href="history.html">6. Version history</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Charliecloud</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>1. Installation</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="installation">
<h1>1. Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#prequisites" id="id2">Prequisites</a><ul>
<li><a class="reference internal" href="#run-time" id="id3">Run time</a></li>
<li><a class="reference internal" href="#build-time" id="id4">Build time</a></li>
<li><a class="reference internal" href="#test-suite" id="id5">Test suite</a></li>
</ul>
</li>
<li><a class="reference internal" href="#install-docker-build-systems-only" id="id6">Install Docker (build systems only)</a><ul>
<li><a class="reference internal" href="#understand-the-security-implications-of-docker" id="id7">Understand the security implications of Docker</a></li>
<li><a class="reference internal" href="#configuring-docker-for-a-proxy" id="id8">Configuring Docker for a proxy</a></li>
</ul>
</li>
<li><a class="reference internal" href="#install-charliecloud" id="id9">Install Charliecloud</a><ul>
<li><a class="reference internal" href="#download" id="id10">Download</a></li>
<li><a class="reference internal" href="#build" id="id11">Build</a></li>
<li><a class="reference internal" href="#install-optional" id="id12">Install (optional)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#test-charliecloud" id="id13">Test Charliecloud</a><ul>
<li><a class="reference internal" href="#id1" id="id14">Build</a></li>
<li><a class="reference internal" href="#run" id="id15">Run</a></li>
<li><a class="reference internal" href="#test-suites-of-examples" id="id16">Test suites of examples</a></li>
<li><a class="reference internal" href="#multiple-phases" id="id17">Multiple phases</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="prequisites">
<h2><a class="toc-backref" href="#id2">1.1. Prequisites</a><a class="headerlink" href="#prequisites" title="Permalink to this headline">¶</a></h2>
<p>Charliecloud is a simple system with limited prerequisites. If your system
meets these prerequisites but Charliecloud doesn&#8217;t work, please report that as
a bug.</p>
<div class="section" id="run-time">
<h3><a class="toc-backref" href="#id3">1.1.1. Run time</a><a class="headerlink" href="#run-time" title="Permalink to this headline">¶</a></h3>
<p>Systems used for running images need:</p>
<ul class="simple">
<li>Recent Linux kernel with <code class="code docutils literal"><span class="pre">CONFIG_USER_NS=y</span></code>.</li>
<li>C compiler and standard library</li>
<li>POSIX shell and utilities</li>
</ul>
<p>Tested and working by us include the Ubuntu and upstream versions of 4.4.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">We are open to patches to make Charliecloud available on older kernels. The
key is likely a setuid binary to avoid the user namespace. Please contact
us if you are interested.</p>
</div>
</div>
<div class="section" id="build-time">
<h3><a class="toc-backref" href="#id4">1.1.2. Build time</a><a class="headerlink" href="#build-time" title="Permalink to this headline">¶</a></h3>
<p>Systems used for building images need the run-time prerequisites, plus:</p>
<ul class="simple">
<li><a class="reference external" href="https://www.docker.com/">Docker</a>, recent version. We do not make compatibility guarantees with any specific version, but let us know if you run into issues.</li>
<li>Bash</li>
<li>root access using <code class="code docutils literal"><span class="pre">sudo</span></code></li>
<li>Internet access or a Docker configured for a local Docker hub</li>
</ul>
</div>
<div class="section" id="test-suite">
<h3><a class="toc-backref" href="#id5">1.1.3. Test suite</a><a class="headerlink" href="#test-suite" title="Permalink to this headline">¶</a></h3>
<p>In order to run the test suite on a run or build system (you can test each
mode independently), you also need:</p>
<ul class="simple">
<li>Bash 4.1+</li>
<li>Python 2.6+</li>
</ul>
</div>
</div>
<div class="section" id="install-docker-build-systems-only">
<h2><a class="toc-backref" href="#id6">1.2. Install Docker (build systems only)</a><a class="headerlink" href="#install-docker-build-systems-only" title="Permalink to this headline">¶</a></h2>
<p>Tnstalling Docker is beyond the scope of this documentation, but here are a
few tips.</p>
<div class="section" id="understand-the-security-implications-of-docker">
<h3><a class="toc-backref" href="#id7">1.2.1. Understand the security implications of Docker</a><a class="headerlink" href="#understand-the-security-implications-of-docker" title="Permalink to this headline">¶</a></h3>
<p>Because Docker (a) makes installing random crap from the internet really easy
and (b) has an &#8220;interesting&#8221; security culture, you should take care. Some of
the implications are below. This list should not be considered comprehensive
nor a substitute for appropriate expertise; adhere to your moral and
institutional responsibilities.</p>
<p>(All this stuff is a key motivation for Charliecloud.)</p>
<div class="section" id="don-t-pipe-web-pages-to-your-shell">
<h4>1.2.1.1. Don&#8217;t pipe web pages to your shell<a class="headerlink" href="#don-t-pipe-web-pages-to-your-shell" title="Permalink to this headline">¶</a></h4>
<p>This is how Docker recommends you install the software. Don&#8217;t do this:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> curl -fsSL https://get.docker.com/ <span class="p">|</span> sh
</pre></div>
</div>
<p>This approach &#8212; piping a web page directly into a shell &#8212; is easy and
fashionable but stupid.</p>
<p>The problem is that you&#8217;ve invited the web page to execute arbitrary code as
you (or worse, root). Auditing the page in a browser only helps somewhat, as
the server could use your <code class="code docutils literal"><span class="pre">User-Agent</span></code> header to decide whether to show
you safe or malicious code.</p>
<p>Download the script to a file and audit it carefully before running.</p>
</div>
<div class="section" id="docker-equals-root">
<h4>1.2.1.2. <code class="code docutils literal"><span class="pre">docker</span></code> equals root<a class="headerlink" href="#docker-equals-root" title="Permalink to this headline">¶</a></h4>
<p>Anyone who can run the <code class="code docutils literal"><span class="pre">docker</span></code> command or interact with the Docker
daemon can <a class="reference external" href="http://reventlov.com/advisories/using-the-docker-command-to-root-the-host">trivially escalate to root</a>.
This is considered a feature.</p>
<p>For this reason, don&#8217;t create the <code class="code docutils literal"><span class="pre">docker</span></code> group when the installer
offers it, as this will allow passwordless, unlogged escalation for anyone in
the group.</p>
</div>
<div class="section" id="images-can-contain-bad-stuff">
<h4>1.2.1.3. Images can contain bad stuff<a class="headerlink" href="#images-can-contain-bad-stuff" title="Permalink to this headline">¶</a></h4>
<p>Standard hygiene for &#8220;installing stuff from the internet&#8221; applies. Only work
with images you trust. The official DockerHub repositories can help.</p>
</div>
<div class="section" id="containers-run-as-root">
<h4>1.2.1.4. Containers run as root<a class="headerlink" href="#containers-run-as-root" title="Permalink to this headline">¶</a></h4>
<p>By default, Docker runs container processes as root. In addition to being poor
hygiene, this can be an escalation path, e.g. if you bind-mount host
directories.</p>
</div>
<div class="section" id="docker-alters-your-network-configuration">
<h4>1.2.1.5. Docker alters your network configuration<a class="headerlink" href="#docker-alters-your-network-configuration" title="Permalink to this headline">¶</a></h4>
<p>To see what it did:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> ifconfig    <span class="c1"># note docker0 interface</span>
<span class="gp">$</span> brctl show  <span class="c1"># note docker0 bridge</span>
<span class="gp">$</span> route -n
</pre></div>
</div>
</div>
<div class="section" id="docker-installs-services">
<h4>1.2.1.6. Docker installs services<a class="headerlink" href="#docker-installs-services" title="Permalink to this headline">¶</a></h4>
<p>If you don&#8217;t want the service starting automatically at boot, e.g.:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> systemctl is-enabled docker
<span class="go">enabled</span>
<span class="gp">$</span> systemctl disable docker
<span class="gp">$</span> systemctl is-enabled docker
<span class="go">disabled</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="configuring-docker-for-a-proxy">
<h3><a class="toc-backref" href="#id8">1.2.2. Configuring Docker for a proxy</a><a class="headerlink" href="#configuring-docker-for-a-proxy" title="Permalink to this headline">¶</a></h3>
<p>By default, Docker does not work if you have a proxy, and it fails in two
different ways.</p>
<p>The first problem is that Docker itself must be told to use a proxy. This
manifests as:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> sudo docker run hello-world
<span class="go">Unable to find image &#39;hello-world:latest&#39; locally</span>
<span class="go">Pulling repository hello-world</span>
<span class="go">Get https://index.docker.io/v1/repositories/library/hello-world/images: dial tcp 54.152.161.54:443: connection refused</span>
</pre></div>
</div>
<p>If you have a systemd system, the <a class="reference external" href="https://docs.docker.com/engine/admin/systemd/#http-proxy">Docker documentation</a> explains how to
configure this. (If you don&#8217;t have a systemd system, then
<code class="code docutils literal"><span class="pre">/etc/default/docker</span></code> might be the place to go?)</p>
<p>The second problem is that Docker containers need to know about the proxy as
well. This manifests as images failing to build because they can&#8217;t download
stuff from the internet.</p>
<p>The fix is to set the proxy variables in your environment, e.g.:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">export HTTP_PROXY=http://example.com:8088</span>
<span class="go">export http_proxy=$HTTP_PROXY</span>
<span class="go">export HTTPS_PROXY=$HTTP_PROXY</span>
<span class="go">export https_proxy=$HTTP_PROXY</span>
<span class="go">export ALL_PROXY=$HTTP_PROXY</span>
<span class="go">export all_proxy=$HTTP_PROXY</span>
<span class="go">export NO_PROXY=&#39;localhost,127.0.0.1,.example.com&#39;</span>
<span class="go">export no_proxy=$NO_PROXY</span>
</pre></div>
</div>
<p><code class="code docutils literal"><span class="pre">ch-build</span></code> will then pass these through to your image builds.</p>
<p>Because different programs use different subsets of these variables, and to
avoid a situation where some things work and others don&#8217;t, the Charliecloud
test suite (see below) includes a test that fails if some but not all of the
above variables are set.</p>
</div>
</div>
<div class="section" id="install-charliecloud">
<h2><a class="toc-backref" href="#id9">1.3. Install Charliecloud</a><a class="headerlink" href="#install-charliecloud" title="Permalink to this headline">¶</a></h2>
<div class="section" id="download">
<h3><a class="toc-backref" href="#id10">1.3.1. Download</a><a class="headerlink" href="#download" title="Permalink to this headline">¶</a></h3>
<p>See our GitHub project: <a class="reference external" href="https://github.com/hpc/charliecloud">https://github.com/hpc/charliecloud</a></p>
<p>The recommended way to download is with <code class="code docutils literal"><span class="pre">git</span> <span class="pre">clone</span> <span class="pre">--recursive</span></code>; the
switch gets the submodule needed for testing as well.</p>
<p>The remaining install steps can be run from the Git working directory or an
unpacked export tarball created with <code class="code docutils literal"><span class="pre">make</span> <span class="pre">export</span></code>.</p>
</div>
<div class="section" id="build">
<h3><a class="toc-backref" href="#id11">1.3.2. Build</a><a class="headerlink" href="#build" title="Permalink to this headline">¶</a></h3>
<p>Just say:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> make
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you wish to build the documentation, see <code class="code docutils literal"><span class="pre">doc-src/README</span></code>.</p>
</div>
</div>
<div class="section" id="install-optional">
<h3><a class="toc-backref" href="#id12">1.3.3. Install (optional)</a><a class="headerlink" href="#install-optional" title="Permalink to this headline">¶</a></h3>
<p>You can run Charliecloud from the source directory, and it&#8217;s recommended you
at least run the test suite before installation to establish that your system
will work.</p>
<p>To install (FHS-compliant):</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> make install <span class="nv">PREFIX</span><span class="o">=</span>/foo/bar
</pre></div>
</div>
<p>Note that <code class="code docutils literal"><span class="pre">PREFIX</span></code> is required; it does not default to
<code class="code docutils literal"><span class="pre">/usr/local</span></code> like many packages.</p>
</div>
</div>
<div class="section" id="test-charliecloud">
<h2><a class="toc-backref" href="#id13">1.4. Test Charliecloud</a><a class="headerlink" href="#test-charliecloud" title="Permalink to this headline">¶</a></h2>
<p>Charliecloud comes with a fairly comprehensive <a class="reference external" href="https://github.com/sstephenson/bats">Bats</a> test suite, in <code class="code docutils literal"><span class="pre">test</span></code>. Go there:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> <span class="nb">cd</span> <span class="nb">test</span>
</pre></div>
</div>
<p>Bats must be installed in the <code class="code docutils literal"><span class="pre">test/bats.src</span></code>. In the Git repository,
this is arranged with a Git submodule, so if you downloaded Charliecloud with
Git command above, it should already be there. Otherwise, you must download
and unpack Bats manually.</p>
<p><code class="code docutils literal"><span class="pre">test/bats</span></code> is a symlink to the main Bats script, for convenience.</p>
<p>Verify the Bats install with:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> ./bats --version
<span class="go">Bats 0.4.0</span>
</pre></div>
</div>
<p>Just like for normal use, the Charliecloud test suite is split into build and
run phases, and there is an additional phase that runs the examples&#8217; test
suites. These phase can be tested independently on different systems.</p>
<p>Testing is coordinated by <code class="code docutils literal"><span class="pre">make</span></code>. The test targets run one or more test
suites. If any test suite has a failure, testing stops with an error message.</p>
<p>Both the build and run phases require a work directory with several gigabytes
of free space. This is configured with an environment variable:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> <span class="nb">export</span> <span class="nv">CH_TEST_WORKDIR</span><span class="o">=</span>/data
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Bats will wait until all descendant processes finish before exiting, so if
you get into a failure mode where a test suite doesn&#8217;t clean up all its
processes, it will hang.</p>
</div>
<div class="section" id="id1">
<h3><a class="toc-backref" href="#id14">1.4.1. Build</a><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>In this phase, image building and associated functionality is tested.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> make test-build
<span class="go">./bats build.bats build_auto.bats</span>
<span class="go"> ✓ executables --help</span>
<span class="go"> ✓ ch-build</span>
<span class="go"> ✓ ch-build --pull</span>
<span class="go"> ✓ ch-build2dir</span>
<span class="go"> ✓ ch-build alpine34</span>
<span class="go"> ✓ ch-docker2tar alpine34</span>
<span class="go">[...]</span>
<span class="go"> ✓ ch-build spark</span>
<span class="go"> ✓ ch-docker2tar spark</span>

<span class="go">28 tests, 0 failures</span>
</pre></div>
</div>
<p>Note that with an empty Docker cache, this test can be quite lengthy, half an
hour or more, because it builds all the examples as well as several basic
Dockerfiles for common Linux distributions and tools (in <code class="code docutils literal"><span class="pre">test</span></code>). With a
full cache, expect more like 1&#8211;2 minutes.</p>
<p>To iterate faster, you can cancel the test with Control-C once it gets into
repetitive testing of different Dockerfiles.</p>
<p>The easiest way to update the Docker images used in this test is to simply
delete all Docker images and let them be rebuilt.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> sudo docker rm <span class="k">$(</span>sudo docker ps -aq<span class="k">)</span>
<span class="gp">$</span> sudo docker rmi -f <span class="k">$(</span>sudo docker images -q<span class="k">)</span>
</pre></div>
</div>
</div>
<div class="section" id="run">
<h3><a class="toc-backref" href="#id15">1.4.2. Run</a><a class="headerlink" href="#run" title="Permalink to this headline">¶</a></h3>
<p>The run tests require the contents of <code class="code docutils literal"><span class="pre">$CH_TEST_WORKDIR/tarballs</span></code>
produced by a successful, complete build test. Copy this directory to the run
system.</p>
<p>Run-time testing requires an additional environment variable specifing the
location(s) of specially constructed filesystem permissions test directories.
These should include every meaningful mounted filesystem, and they cannot be
shared between different users. For example:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> <span class="nb">export</span> <span class="nv">CH_TEST_PERMDIRS</span><span class="o">=</span><span class="s1">&#39;/data /tmp /var/tmp&#39;</span>
</pre></div>
</div>
<p>These directories must be created as root. For example:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> <span class="k">for</span> d in <span class="nv">$CH_TEST_PERMDIRS</span><span class="p">;</span> <span class="k">do</span> sudo ./make-perms-test <span class="nv">$d</span> <span class="nv">$USER</span> nobody<span class="p">;</span> <span class="k">done</span>
</pre></div>
</div>
<p>To skip this test (e.g., if you don&#8217;t have root), set
<code class="code docutils literal"><span class="pre">$CH_TEST_PERMDIRS</span></code> to <code class="code docutils literal"><span class="pre">skip</span></code>.</p>
<p>To run the tests:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> make test-run
</pre></div>
</div>
</div>
<div class="section" id="test-suites-of-examples">
<h3><a class="toc-backref" href="#id16">1.4.3. Test suites of examples</a><a class="headerlink" href="#test-suites-of-examples" title="Permalink to this headline">¶</a></h3>
<p>Some of the examples include test suites of their own. This Charliecloud runs
those test suites, using a SLURM allocation if one is available or a single
node (localhost) if not.</p>
<p>These require that the run tests have been completed successfully.</p>
<p>Note that this test can take quite a while, and that single tests from
the Charliecloud perspective include entire test suites from the example&#8217;s
perspective, so be patient.</p>
<p>To run the tests:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> make test-test
</pre></div>
</div>
</div>
<div class="section" id="multiple-phases">
<h3><a class="toc-backref" href="#id17">1.4.4. Multiple phases</a><a class="headerlink" href="#multiple-phases" title="Permalink to this headline">¶</a></h3>
<p>We also provide multiple-phase targets:</p>
<blockquote>
<div><ul class="simple">
<li><code class="code docutils literal"><span class="pre">test</span></code>: build and run phases</li>
<li><code class="code docutils literal"><span class="pre">test-all</span></code>: all three phases</li>
</ul>
</div></blockquote>
<p>We recommend that a build box pass all phases so it can be used to run
containers for testing and development.</p>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="tutorial.html" class="btn btn-neutral float-right" title="2. Tutorial" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="Overview" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; <a href="copyright.html">Copyright</a> 2014–2016, Los Alamos National Security, LLC.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.2.0.pre',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>